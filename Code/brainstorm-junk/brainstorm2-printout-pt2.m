KC<x,y> := FunctionField(C);
/*
proj := y/x;
> Support(Divisor(Differential(proj)));
[
Place at (1/714114644676*(28439664306*nu + 121525853) : 1/178528661169*(53769820850*nu + 1819900457) : 1),
Place at (1/166711731620*(3817625355*nu + 43141697) : 1/225060837687*(27871736990*nu + 1632496091) : 1),
Place at (1/54653752566*(-771737684*nu - 81749849) : 1/27326876283*(621577900*nu + 91977643) : 1),
Place at (1/82331249779632*(1175844121461*nu - 160709388557) : 1/3430468740818*(-399542749335*nu - 30061789915) : 1),
Place at (0 : $.1 : 1)
]
[ 1, 1, 1, 1, -2 ]
> $1[#$1];
Place at (0 : $.1 : 1)
> RepresentativePoint($1);
(0 : $.1 : 1)
> pt := $1;
> Parent(pt[2]);
Number Field with defining polynomial X^2 + 1/6388311052163493019431*(-723610599325897091600*nu - 75580475952976576940)*X + 1/3709341901256221753218*(688461762457232300*nu + 121399255837295255) over fld
> proj(sing_pts[2]);
0
*/                                                                                                               
pts_y := Support(Divisor(ysq_leg_al));
/*
[
Place at (1/627*(26660*nu + 1550) : $.1 : 1),
Place at ($.1 : 1/8892405446607904096686812654671723158200693593719800000*(-56867566809704340290465234633757196320135775726171110356580*nu - 3760281752402056698402521697653235471376870855750449088797)*fld2.1*$.1 + 1/8892405446607904096686812654671723158200693593719800000*(27746747947824232185813829102991091968242877105473506329340*nu - 2266203505569370063533908027711495918992023063178738667493)*fld2.1 : 1),
Place at ($.1 : 1/174262917746685767029482580775028086504817653505886584895600*(-1334812831399984467869091377728807691256926376746146028326383060*nu - 38237012949598478284158380374352351518019296816528157796518889)*fld2.1*$.1^3 + 1/35593200949760567915771817123299486668609005728577334964926300000*(177759601458599507310565436975149232675729498212081318207716478097940*nu + 10245590839721400376234866909730274389855083501070024081712758323513)*fld2.1*$.1^2 + 1/35593200949760567915771817123299486668609005728577334964926300000*(144401585504098138020996903540897980054227707681188067318236921323260*nu + 5349018780744771355855650627952990024223037103792473218066382053019)*fld2.1*$.1 + 1/3911340763709952518216683200362580952594396233909597248893000*(-5226115284800648786594229479013515213119933473260476998624276420*nu - 885689723368019513315038285999184802977847165822514881434977749)*fld2.1 : 1),
Place at ($.1 : 1/758710565271865270944089101939193457003914082269092048000000*(20071023383850476050346701923962909991448737496258490341459897860*nu - 4843833120280487953222023944277353049231841114845777524173606491)*fld2.1*$.1^3 + 1/94838820658983158868011137742399182125489260283636506000000*(16334023042977541949757557793441903233175157592469099444264271980*nu + 2003997486279587906065619647466614040487760288598657096464520679)*fld2.1*$.1^2 + 1/758710565271865270944089101939193457003914082269092048000000*(-114557971373386070029463259179539668175568200453099256683589010540*nu - 12173288050461042103209789451994752066518670859985230917482442983)*fld2.1*$.1 + 1/379355282635932635472044550969596728501957041134546024000000*(-8021636981584759344365974259310376161023048342793197247202009860*nu + 122535434684690894527468798627854357811325929912031673286493211)*fld2.1 : 1)
]
[ 1, 3, 2, -4 ]
*/
pts_y := [* RepresentativePoint(pt) : pt in pts_y *];
K1 := Parent(pts_y[1][2]);
K2 := Parent(pts_y[2][2]);
poly2 := DefiningPolynomial(K2);  
cs2 := Coefficients(poly2);
R2 := PolynomialRing(K1);
K3 := NumberField(R2!cs2);
E3 := ChangeRing(E_leg_al, K3);
KE3 := FunctionField(E3);
A_leg_al := CoordinateRing(AffinePatch(E_leg_al,1));
A3<x3,y3> := CoordinateRing(AffinePatch(E3,1));
mp3 := hom< A_leg_al -> A3 | [A3.1, A3.2]>; 
ysq_3 := (KE3!(mp3(Numerator(ysq_leg_al))))/(KE3!(mp3(Denominator(ysq_leg_al))));
pts := Support(Divisor(ysq_3));
/*
[
Place at (1/627*(26660*nu + 1550) : K1.1 : 1),
Place at (1/627*(26660*nu + 1550) : -K1.1 : 1),
Place at (K3.1 : 1/8892405446607904096686812654671723158200693593719800000*(-56867566809704340290465234633757196320135775726171110356580*nu - 3760281752402056698402521697653235471376870855750449088797)*fld2.1*K3.1 + 1/8892405446607904096686812654671723158200693593719800000*(27746747947824232185813829102991091968242877105473506329340*nu - 2266203505569370063533908027711495918992023063178738667493)*fld2.1 : 1),
Place at (-K3.1 + 1/1343514339*(1298022080*nu + 2635510250) : 1/8892405446607904096686812654671723158200693593719800000*(56867566809704340290465234633757196320135775726171110356580*nu + 3760281752402056698402521697653235471376870855750449088797)*fld2.1*K3.1 + 1/69865931144558000377985819846538686554859633233380068118200000*(-657843736242487996506487220248655648218172191381463340882172183260*nu - 74899834870695282052100794173113109805269100504248529861429812723)*fld2.1 : 1),
Place at ($.1 : 1/174262917746685767029482580775028086504817653505886584895600*(-1334812831399984467869091377728807691256926376746146028326383060*nu - 38237012949598478284158380374352351518019296816528157796518889)*fld2.1*$.1^3 + 1/35593200949760567915771817123299486668609005728577334964926300000*(177759601458599507310565436975149232675729498212081318207716478097940*nu + 10245590839721400376234866909730274389855083501070024081712758323513)*fld2.1*$.1^2 + 1/35593200949760567915771817123299486668609005728577334964926300000*(144401585504098138020996903540897980054227707681188067318236921323260*nu + 5349018780744771355855650627952990024223037103792473218066382053019)*fld2.1*$.1 + 1/3911340763709952518216683200362580952594396233909597248893000*(-5226115284800648786594229479013515213119933473260476998624276420*nu - 885689723368019513315038285999184802977847165822514881434977749)*fld2.1 : 1),
Place at ($.1 : 1/758710565271865270944089101939193457003914082269092048000000*(20071023383850476050346701923962909991448737496258490341459897860*nu - 4843833120280487953222023944277353049231841114845777524173606491)*fld2.1*$.1^3 + 1/94838820658983158868011137742399182125489260283636506000000*(16334023042977541949757557793441903233175157592469099444264271980*nu + 2003997486279587906065619647466614040487760288598657096464520679)*fld2.1*$.1^2 + 1/758710565271865270944089101939193457003914082269092048000000*(-114557971373386070029463259179539668175568200453099256683589010540*nu - 12173288050461042103209789451994752066518670859985230917482442983)*fld2.1*$.1 + 1/379355282635932635472044550969596728501957041134546024000000*(-8021636981584759344365974259310376161023048342793197247202009860*nu + 122535434684690894527468798627854357811325929912031673286493211)*fld2.1 : 1)
]
[ 1, 1, 3, 3, 2, -4 ]
*/
pts := pts[1..4];
pts := [RepresentativePoint(pt) : pt in pts];
pt_new := &+pts;
// (-20693401/26764920 : 1/9434515415468538649680691551007900130470880722258808000000*(-76086052759788415332214922411331277493596429533656595720784940*nu - 680154701120019355607066843131691806575400674639208498363031)*fld2.1 : 1)
Q := pt_new/2;
// (-133/39 : 1/90142464392638567919080470658523388668612477500*(-6368757662730100600225470861641696433406787312697060*nu - 56932122346729957664552971068777656923201423246269)*fld2.1 : 1)
oo := E3!0;
D := Divisor(pts[1]) + Divisor(pts[2]) + Divisor(pts[3]) + Divisor(pts[4]) - 2*Divisor(Q) - 2*Divisor(oo);
princ_bool, f3 := IsPrincipal(D);
//true (1/52397059221*(-7272970036150*nu + 167591415110)*$.1 + 1/10950985377189*(-2097834201968750*nu - 215359569436130))/($.1^2 + 266/39*$.1 + 17689/1521)*$.1 + (1/19436102130197377375167889173526235264470828802500*(-704457552690025717339671633348014345655386015550812700*nu - 13405070291286621251669721907532642032117226779012419)*fld2.1*$.1^3 + 1/3895276690372442287955584924767673677411288919038636250*(412672378013932607265909837805570523951812473796071028940220*nu + 11836926085384480702356164176688492994816650956575277174419)*fld2.1*$.1^2 + 1/148020514234152806942312227141171599741628978923468177500*(-32463592847387108405114804326379385487721349457610409074221260*nu - 249585512983586312210277383276465793302250004455839367247263)*fld2.1*$.1 + 1/556468098624634612565083560681096239630184131291233750*(-50329358003121312186471635395004466270131873825231957847660*nu - 5269090047567817868098041351729518472269068543255437090591)*fld2.1)/($.1^2 + 266/39*$.1 + 17689/1521)
f3/ysq_3;
//(1/446388412698671055360539070851*(20687506891660400217761691144933276372373440*nu - 323093471704437700704722589500861242297944)*$.1^13 + 1/1891389229107776114684032930551115*(533712269915815424482202041767089515742598571335*nu + 72139030659479944001624395707953810571614486553)*$.1^12 + 1/26350834739929536829777946788438134180*(-96404713516467991409201497251019019183767453016847275*nu - 4858931193305734524734898482071977811766362464862973)*$.1^11 + 1/13171363395389394639992084479328538146280*(91109005633766081757893619824416048874636241737497609015*nu + 2292254430003211295273001615755427452654310386225571409)*$.1^10 + 1/21656760967419100802294677365049807913595*(56042047346661591983207760620525043283174388872181272435*nu + 3417483747810171589048081582143149154150326656972910293)*$.1^9 + 1/2278957615648409992118393741183702863522920*(-21986471357376833258163528841190443018608500687824020773035*nu + 396213039877740746832828292274377447585684473655866687299)*$.1^8 + 1/194850876137939054326122664871206594831209660*(-656823488532433416239165842734357547820030819128706529308875*nu - 166594235816526859731472039641872959648212211911228362848477)*$.1^7 + 1/66638999639175156579533951385952655432273703720*(131177908784976099403096339337149109940384281832823794176688905*nu + 10669992639523532310069054225156001150854294478952411159064431)*$.1^6 + 1/4543568157216487948604587594496771961291388890*(81042462802922017661865705070441692370790193387413595583561325*nu + 4132676084956287675297076864555549174951361198603341676776571)*$.1^5 + 1/43302021965536016745381161610592035499891452677256*(-894857390478615653422255543861038568899426053694965797011250941929*nu - 40888588694807729061929601580703922497636996522941119029986746191)*$.1^4 + 1/134142133262801791004713381076290544755098521880630*(1448843100394553915056614748397550691452378957865363416907030731175*nu + 75160444896364702727568554828905995745224085674181188909465497569)*$.1^3 + 1/166219599912602219288449189594533935892187298852085*(-590081303185351004269836485604552576687108167594864083612360156360*nu - 38541354342489698907564361087343788316940363490976704604149809592)*$.1^2 + 1/498658799737806657865347568783601807676561896556255*(244983022185764449014948136256719973247480684602567249615615950330*nu + 22949339131893172215852699119294548636516445864402770892163675958)*$.1 + 1/1894903439003665299888320761377686869170935206913769*(-71156613958352778306794622381165244753972171813124546668056475190*nu - 6888347647785679009410683457741046263367050295397098659527539226))/($.1^14 + 1/148984488262510875*(13467278745337838440*nu + 644154269880984259)*$.1^13 + 1/5919034064757930848406922531537500*(1667388837436785670612153080036655514*nu - 55878760335489582334141607778289375)*$.1^12 + 1/843462354228005145897986460744093750*(-851515117222584524443486271059865168185*nu - 38536392195214224787285096957927683694)*$.1^11 + 1/468004196636834317657073485997636453400000*(-1054691313223172690797568110964934286843006759*nu + 8339272732587915800791490050724321214139535)*$.1^10 + 1/133381196041497780532265943509326389219000000*(504554984015494364481000578161596882961501093835*nu + 12563660036148976776320259516575920539042995549)*$.1^9 + 1/273698214277153445652209716081137750677388000000*(848439673626880004909459775296338948465187169377995*nu + 19209492309002701070036589098128052555919044890909)*$.1^8 + 1/3600184203184095323579066265374965797371796000000*(-4091519310495128248270646380565711855180650649726035*nu + 324967814850120846160867813020940601268315584562731)*$.1^7 + 1/189425076536763169332929332732036661954023728000000*(-1411573354006877528171296491025462382699400362580709015*nu - 94081528475549118963720610369899861120617700160728433)*$.1^6 + 1/284137614805144753999393999098054992931035592000000*(2017865321914181855507348077025631754680406523792637925*nu + 43997132178258152826042387028434160592132933092354867)*$.1^5 + 1/205147357889314512387562467348795704896207697424000000*(775621477717410454674769770723701916197743289078237396765*nu + 77592960547770401289501065191973155239045716646545366843)*$.1^4 + 1/335451711664940154703499674080516232570107063375000*(-3575383263297535045652146943196953762453125834777231955*nu - 68106356366812953226466095633865911843873834675562609)*$.1^3 + 1/5538978663011491834464186618417484032197607830448000000*(-2702315760662272028937716654217607368094889398547240527825*nu - 1629963427923254588396651796804941802469945578136612332007)*$.1^2 + 1/788675951290492454060561137257942850275417600*(4129488803239944807802906602933723632688555952687*nu + 170962946299116148231178731955427786108240605977)*$.1 + 1/11229683195886915251865733592423795712*(-4216993599775561211768261057426124109195*nu + 241052079187812670872753616117049584163))*$.1 + (1/17292649886853208917940991278168147581737911216344293332415617466500*(93624095263287458935258525058107318021527307780880428696543606352945939913006420900*nu + 4257735614134105699685011133786952801604361357918874761183545920741782978303966829)*fld2.1*$.1^15 + 1/8297380335251503750927405698540547066579548056578630814578451901447501632193875000*(-996602839523833229032999433835541817576663143396773467841772346185751760580020303884188077164166060*nu - 14666855455471940857595764525914449993310642133271886306013968916437364068578069294598471253131831)*fld2.1*$.1^14 + 1/107865944358269548762056274081027111865534124735522200589519874718817521218520375000*(23342570621310250357890133094182753465988930254762636159569584330110701449720574356691776510701583340*nu - 2164468548669785249138479740299844794918943508148317287238056777742045979078518861956978441672286353)*fld2.1*$.1^13 + 1/53932972179134774381028137040513555932767062367761100294759937359408760609260187500*(71813720930895702458757670140227436154942713356177079544548610643742837732283417732981163678722364100*nu + 6198485510713852976201180994126010485040075782183021294508118034804222997083793615639824839760269703)*fld2.1*$.1^12 + 1/622303525143862781319555427390541029993466104243397311093383892608562622414540625*(-1764685793889115704070230343565954867565790710189385747843630768174086665146887348960018472347111625*nu - 69798970894864882637747253494895387273597432236471179423050199037047433385013514908713292659047281)*fld2.1*$.1^11 + 1/163713696614770054777913812436588486352127236654801446456874839440098782204440687500*(-562193119078335843222664682565166446185504513162764675716386780742256643330162585164696965168079238000*nu - 27431246575764071908643137710748546608938777774952417937133529281858911253044853424613735542509958857)*fld2.1*$.1^10 + 1/2153464778548129182078712455896663935862596728305465180317353657250530135150719812500*(23382693262919097706628158398610727525447887608057387048623725167758316110904181463056573231328301346600*nu + 511305964695870041133341250177231053116523334295272622558061641937003302163314516170964668388103036347)*fld2.1*$.1^9 + 1/92060619282932522533864957489582383258126010135058636458566868847460163277693271984375*(-568164286403983464117495746706166309954711063347478379014591588724104511907676256313785805702134339243435*nu + 585379998007392938264684015593639242616421997566255934423420444690664566448625131014261634133899410034)*fld2.1*$.1^8 + 1/62969463589525845413163630922874350148558190932380107337659738291662751681942198037312500*(85720073508839233932909721577169962147036306838411623954570371385951665914328487677515249585696042046931120*nu + 9485942480033665359458520047968524474258490974146078948662455616800518568237826074905978027466644117053547)*fld2.1*$.1^7 + 1/25187785435810338165265452369149740059423276372952042935063895316665100672776879214925000*(-107311715375391443572914956567451323117700929840293012090021688399715771141372920127292313994777251078449996*nu - 11536526676599875089671292764645055860023689163518440818804551882440753639333644805375731082289922406182681)*fld2.1*$.1^6 + 1/9092790542327532077660828305263056161451802770635687499558066209316101342872453396587925000*(32510132142244373482990733886796166404877046568440545866685382133412143236594987771918094022457978628598365228*nu + 2994918397131849914845143844584210058463369899214742746393189980691460527990135482654616314882409750234019661)*fld2.1*$.1^5 + 1/7800337037147197250568570101337705369272198697886467704470381213008628743969178248243487500*(720817122707277637731351407417127127677681823640143525081956373305259216918444880813558508251364203453702200*nu - 603358417815239268588162419047793400076648293455789809817157189596268776647734404420232483892015865911905107)*fld2.1*$.1^4 + 1/160556937347946476740869734585867768850852756531496460250348679967760941646698918943011784375*(-163765949083683080364582966420801937611982529141560361916682080845890974576309478409363176841370928004992778756*nu - 2767244327381814810597554751401155708470388780140104767969419109441319672094765818257890300685970543540602217)*fld2.1*$.1^3 + 1/137276181432494237613443623070916942367479106834429473514048121372435605107927575696275075640625*(63801523355545696997055362769689144975611923997263966978127253369406756564828382343993944657618574187988703422120*nu + 2505586009247407202411019063464979756378874422414837334000644611565497173197760309422868734254157074257005067108)*fld2.1*$.1^2 + 1/2294473318228832257253271985613897465285007928518321200163375742939280828232503765209169121421875*(-151523412684684159372409852081602561249881864375501172622666823889791703029505368530456171562198893097150376648440*nu - 7234967036328088978268275687577739480504210959686860217554546272813825550210078207537851936943004114878072707594)*fld2.1*$.1 + 1/246893439490909627261707612747134110620200726702443536407750224535142596552114142086074125*(639368894326253950420822521440283195722155342699200655688332862890977965568118052233106075859158127853600*nu + 18526846098702217661632133492644274422695896741939577613051093094823533209509994268585611792044354575884)*fld2.1)/($.1^14 + 1/148984488262510875*(13467278745337838440*nu + 644154269880984259)*$.1^13 + 1/5919034064757930848406922531537500*(1667388837436785670612153080036655514*nu - 55878760335489582334141607778289375)*$.1^12 + 1/843462354228005145897986460744093750*(-851515117222584524443486271059865168185*nu - 38536392195214224787285096957927683694)*$.1^11 + 1/468004196636834317657073485997636453400000*(-1054691313223172690797568110964934286843006759*nu + 8339272732587915800791490050724321214139535)*$.1^10 + 1/133381196041497780532265943509326389219000000*(504554984015494364481000578161596882961501093835*nu + 12563660036148976776320259516575920539042995549)*$.1^9 + 1/273698214277153445652209716081137750677388000000*(848439673626880004909459775296338948465187169377995*nu + 19209492309002701070036589098128052555919044890909)*$.1^8 + 1/3600184203184095323579066265374965797371796000000*(-4091519310495128248270646380565711855180650649726035*nu + 324967814850120846160867813020940601268315584562731)*$.1^7 + 1/189425076536763169332929332732036661954023728000000*(-1411573354006877528171296491025462382699400362580709015*nu - 94081528475549118963720610369899861120617700160728433)*$.1^6 + 1/284137614805144753999393999098054992931035592000000*(2017865321914181855507348077025631754680406523792637925*nu + 43997132178258152826042387028434160592132933092354867)*$.1^5 + 1/205147357889314512387562467348795704896207697424000000*(775621477717410454674769770723701916197743289078237396765*nu + 77592960547770401289501065191973155239045716646545366843)*$.1^4 + 1/335451711664940154703499674080516232570107063375000*(-3575383263297535045652146943196953762453125834777231955*nu - 68106356366812953226466095633865911843873834675562609)*$.1^3 + 1/5538978663011491834464186618417484032197607830448000000*(-2702315760662272028937716654217607368094889398547240527825*nu - 1629963427923254588396651796804941802469945578136612332007)*$.1^2 + 1/788675951290492454060561137257942850275417600*(4129488803239944807802906602933723632688555952687*nu + 170962946299116148231178731955427786108240605977)*$.1 + 1/11229683195886915251865733592423795712*(-4216993599775561211768261057426124109195*nu + 241052079187812670872753616117049584163))
// IsSquare($1); // hangs forever :(
