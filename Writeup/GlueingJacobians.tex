\documentclass[reqno, 12pt]{amsart}

\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{amsxtra}
\usepackage{mathrsfs}
\usepackage[inline, shortlabels]{enumitem}
\usepackage{comment}
\usepackage{graphicx}
\usepackage{placeins}
\usepackage{multicol}
\usepackage{bbm}
\usepackage{cancel}
\usepackage{fullpage}
\usepackage{stmaryrd}
\usepackage{subcaption}
\usepackage{hyperref}
%\usepackage{calc}
%\usepackage{tikz}
%\usetikzlibrary{arrows,calc,automata,shadows,backgrounds,positioning,intersections,fadings,decorations.pathreplacing,shapes,snakes, matrix}
\usepackage{tikz-cd}

%\usepackage{listings}
%\usepackage{color}
%
%\definecolor{dkgreen}{rgb}{0,0.6,0}
%\definecolor{gray}{rgb}{0.5,0.5,0.5}
%\definecolor{mauve}{rgb}{0.58,0,0.82}
%
%\lstset{frame=tb,
%  language=Python,
%  aboveskip=3mm,
%  belowskip=3mm,
%  showstringspaces=false,
%  columns=flexible,
%  basicstyle={\small\ttfamily},
%  numbers=none,
%  numberstyle=\tiny\color{gray},
%  keywordstyle=\color{blue},
%  commentstyle=\color{dkgreen},
%  stringstyle=\color{mauve},
%  breaklines=true,
%  breakatwhitespace=true,
%  tabsize=3
%}

\setlength{\hfuzz}{4pt}

\newtheorem{thm}{Theorem}%[section]
\newtheorem{lem}{Lemma}
\newtheorem{cor}[thm]{Corollary}
\newtheorem{conj}[thm]{Conjecture}
\newtheorem{prop}[thm]{Proposition}
\theoremstyle{definition}  
\newtheorem{defn} [thm] {Definition} 
\newtheorem{claim}[thm]{Claim}
\newtheorem{example} [thm] {Example}
\newtheorem{rem} [thm] {Remark}
\newtheorem{eg} [thm] {Example}

\newcommand{\C}{\mathbb C}
\newcommand{\D}{\mathbf D}
\renewcommand{\H}{\mathbf H}
\newcommand{\F}{\mathbb F}
\newcommand{\Q}{\mathbb Q}
\newcommand{\R}{\mathbb R}
\newcommand{\Z}{\mathbb Z}
\newcommand{\T}{\mathbb T}
\renewcommand{\P}{\mathbb P}
\renewcommand{\O}{\mathcal O}
\newcommand{\M}{\mathfrak M}
\newcommand{\A}{\mathbb A}
\newcommand{\V}{\mathbb V}
\newcommand{\I}{\mathbb I}
\newcommand{\m}{\mathfrak m}
\renewcommand{\SS}{\mathbb S}

\renewcommand{\L}{\mathcal{L}}

\renewcommand{\Re}{\text{Re}}
\renewcommand{\Im}{\text{Im}}

\newcommand{\gl}{\mathfrak gl}
\renewcommand{\sl}{\mathfrak sl}
\newcommand{\s}{\mathfrak s}
\renewcommand{\a}{\mathfrak a}
\newcommand{\p}{\mathfrak p}
\newcommand{\q}{\mathfrak q}
\newcommand{\normal}{\trianglelefteq}

\newcommand{\charac}{\text{char}}
\newcommand{\la}{\langle}
\newcommand{\ra}{\rangle}
\newcommand{\wt}{\widetilde}

\newcommand{\Kbar}{\overline{K}}
\newcommand{\kal}{k^{\mathrm{al}}}

\renewcommand{\div}{\text{div}}
\newcommand{\wh}{\widehat}

\DeclareMathOperator{\lcm}{lcm}
\DeclareMathOperator{\img}{img}
\DeclareMathOperator{\Tor}{Tor}
\DeclareMathOperator{\Jac}{Jac}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Gal}{Gal}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\ord}{ord}
\DeclareMathOperator{\Ob}{Ob}
\DeclareMathOperator{\genus}{genus}
%\DeclareMathOperator{\GL}{GL}
%\DeclareMathOperator{\SL}{SL}
%\DeclareMathOperator{\SO}{SO}
%\DeclareMathOperator{\Sp}{Sp}
\DeclareMathOperator{\Spec}{Spec}
\DeclareMathOperator{\Stab}{Stab}
\DeclareMathOperator{\Frac}{Frac}
\DeclareMathOperator{\Div}{Div}
\DeclareMathOperator{\Pic}{Pic}
\DeclareMathOperator{\supp}{supp}
\DeclareMathOperator{\Frob}{Frob}
\DeclareMathOperator{\Nm}{Nm}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\Sym}{Sym}

\newcommand{\whinfty}{\wh{\infty}}

\newcommand{\sss}[1]{{\color{blue} [#1]}}
\newcommand{\jh}[1]{{\color{green} [#1]}}


%\newcommand{\res}[3]{\left(\frac{#1}{#2} \right)_{#3}}

\renewcommand{\thesection}{\Roman{section}} 

\usepackage{mathpazo}
%\usepackage{pxfonts}

\everymath{\displaystyle}
\tikzset{commutative diagrams/.cd, arrow style = tikz, diagrams = {>=latex}}


\begin{document}

\title{Glueing Jacobians}
%\author{Alex Levin and Sam Schiavone}
\author{Jeroen Hanselman, Sam Schiavone, and Jeroen Sijsling}
%\date{30 June 2017}
\date{\today}

\maketitle

\tableofcontents

\section{Introduction}
In \cite{FreyKani}
%Frey and Kani's paper \textit{Curves of genus 2 covering elliptic curves and an arithmetical application},
the authors describe a method for glueing two elliptic curves $E_1$ and $E_2$ along their torsion subgroups to produce a genus $2$ curve that covers both of them. In this article, we extend this method to genus $3$: we glue a genus $1$ curve $X_1$ to the Jacobian variety of a genus $2$ curve $X_2$. This produces an abelian $3$-fold which, since all abelian $3$-folds are principally polarized, is the Jacobian variety of a genus $3$ curve $X_3$. We determine explicit equations for $X_3$, given the data of blah. We have implemented this method in \textsf{Magma}, and conclude the paper with several examples.

\sss{Other papers to mention? Howe? Howe, Leprovost, Poonen? Broker, Lauter, Stevenhagen, etc.?}

\section{Background}

Encoding divisors as polynomials as in Mumford and Cantor. Describe construction of the Kummer as in Mueller.

\subsection{Definitions and conventions}
Throughout, let $k$ be a field of characteristic $\neq 2$. A \textit{hyperelliptic curve} over $k$ is a curve $C$ of genus $g \geq 2$ with a model of the form $y^2 = f(x)$, where $f \in k[x]$ has distinct roots. Then $\deg(f)$ is either $2g+1$ or $2g+2$---we call the model \textit{odd} or \textit{even} according to the parity of $\deg(f)$. Note that an odd model has the single point $\infty = (1:0:0)$ at infinity while an even model has two: letting $c$ be the leading coefficient of $f$, then the two points at infinity are $\infty = (1:\sqrt{c}:0)$ and $\infty' = (1:-\sqrt{c}:0)$. Let
\begin{align} \label{infty}
\wh{\infty} =
\begin{cases}
\infty + \infty' & \text{if $\deg(f)$ is even;}\\
2 \infty & \text{if $\deg(f)$ is odd}.
\end{cases}
\end{align}
We denote by $\iota: C \to C$ the hyperelliptic involution that maps $(x,y) \mapsto (x,-y)$.

\subsection{Representing divisors}
Let $C$ be a hyperelliptic curve, $\Div_k(C)$ be the group of $k$-divisors on $C$ \sss{define?}, $\Div^0_k(C)$ be the subgroup of divisors of degree $0$, and $\Jac(C)$ be its Jacobian variety. Denote by $\equiv$ the equivalence relation of linear equivalence on $\Div_k(C)$. We describe how points of $\Jac(C)$ can be represented as pairs of polynomials, as presented in \cite{Cantor} and \cite[\S1]{Mumford}.

Given a point $P = (u,v)$ on $C$, then $\iota(P) = (u,-v)$ also lies on $C$. Since $\div(x - u) = P + \iota(P) - \wh{\infty}$, then $-P' \equiv P - \wh{\infty}$. Then each divisor $D \in \Div^0_k(C)$ is linearly equivalent to one the form \sss{TODO: fix this to make it work in the even model case, too}
\begin{align} \label{semireduced}
\sum_{i=1}^r P_i - r \whinfty
\end{align}
\sss{Again, Cantor and Mumford only consider odd models, so have $\infty$, not $\whinfty$.}
satisfying the following conditions:
\begin{enumerate}
\item
$P_i \notin \{\infty, \infty'\}$ for all $i$; and

\item
$P_j \neq \iota(P_i)$ for all $j \neq i$, i.e., at most one of $P_i$ and $\iota(P_i)$ appears.
\end{enumerate}
A divisor of this form is called \textit{semireduced}.

Given  a semireduced divisor $D = \sum_{i=1}^r P_i - r \whinfty$, we produce a pair $(a(x), b(x))$ of polynomials. Writing $P_i = (u_i, v_i)$ for each $i$, let $a(x) = \prod_{i = 1}^r (x - u_i)$ and $b(x)$ be the unique polynomial of degree at most $r-1$ such that $b(u_i) = v_i$ for all $i$ \sss{TODO: add statement about multiplicities here}. In the case where all the $P_i$ are distinct, we can write $b$ explicitly using Lagrange interpolation as
$$
b(x) = \sum_{i=1}^r  v_i \prod_{j \neq i} \frac{x - u_j}{u_i - u_j} \, .
$$
\sss{Put some statement about a bijection between pairs of polynomials and semireduced divisors here?}
By construction $b(x)^2 \equiv f(x) \pmod{x - u_i}$ for each $i$ \sss{again, add statement about multiplicities}, so $a(x) \mid (b(x)^2 - f(x))$.

The above observation allows us to construct an affine open patch of the Jacobian by giving explicit equations. As in the discussion following \cite[Proposition 1.2]{Mumford}, let $k[a_1, \ldots, a_g, b_1, \ldots, b_g]$ be the polynomial ring in $2g$ indeterminates, and define polynomials $a(x), b(x) \in k[a_1, \ldots, a_g, b_1, \ldots, b_g][x]$
\begin{align*}
a(x) &= x^g + a_1 x^{g-1} + \cdots + a_g\\
b(x) &= b_1 x^{g-1} + \cdots + b_g \, .
\end{align*}
As above, we must have $b(x)^2 - f(x) \equiv 0 \pmod{a(x)}$. To ensure this, we divide $b(x)^2 - f(x)$ by $a(x)$, and then insist that the remainder be $0$ by setting all its coefficients $=0$. This realizes an affine open patch of $\Jac(X_2)$ as a subvariety of $\A^4$. We illustrate this with an example.

\begin{eg}
Consider the genus $2$ hyperelliptic curve
$$
X_2: y^2 = f(x)
$$
where
%\begin{align*}
%f(x) &= x (x-5) (x+2) (x-31) (x+15)(x-4)\\
%	&= x^6 - 23 x^5 - 351 x^4 + 3263 x^3 - 1570 x^2 - 18600 x
%\end{align*}
\begin{align*}
f(x) &= x (x-1) (x-2) (x-3) (x-4) (x-5)\\
	&= x^6 - 15 x^5 + 85 x^4 - 225 x^3 + 274 x^2 - 120 x \, .
\end{align*}
Then
$$
a(x) = x^2 + a_1 x + a_2 \qquad \text{and} \qquad b(x) = b_1 x + b_2 \, .
$$
By long division with remainder, we find that
%\begin{align*}
%b(x)^2 - f(x) &\equiv (-a_1^5 - 23 a_1^4 + 4 a_1^3 a_2 + 351 a_1^3 + 69 a_1^2 a_2 + 3263 a_1^2 - 3 a_1 a_2^2 - 702 a_1 a_2 + a_1 b_1^2 + 1570 a_1 - 23 a_2^2 - 3263 a_2 - 2 b_1 b_2 - 18600) t\\
%	&\qquad - a_1^4 a_2 - 23 a_1^3 a_2 + 3 a_1^2 a_2^2 + 351 a_1^2 a_2 + 46 a_1 a_2^2 + 3263 a_1 a_2 - a_2^3 - 351 a_2^2 + a_2 b_1^2 + 1570 a_2 - b_2^2 \pmod{a(x)} \, .
%\end{align*}
\begin{align*}
b(x)^2 - f(x) &\equiv  c_1 x + c_2 \pmod{a(x)}
\end{align*}
where
\begin{align*}
c_1 &= -a_1^5 - 15 a_1^4 + 4 a_1^3 a_2 - 85 a_1^3 + 45 a_1^2 a_2 - 225 a_1^2 - 3 a_1 a_2^2 + 170 a_1 a_2 + a_1 b_1^2 - 274 a_1\\
	&\qquad \qquad - 15 a_2^2 + 225 a_2 - 2 b_1 b_2 - 120\\
c_2 &= - a_1^4 a_2 - 15 a_1^3 a_2 + 3 a_1^2 a_2^2 - 85 a_1^2 a_2 + 30 a_1 a_2^2 - 225 a_1 a_2 - a_2^3 + 85 a_2^2 + a_2 b_1^2 - 274 a_2 - b_2^2
\end{align*}
Thus an affine patch of $\Jac(X_2)$ is the surface of $\A^4$ defined by $c_1 = c_2 = 0$.
%\begin{align*}
%0 &= -a_1^5 - 23 a_1^4 + 4 a_1^3 a_2 + 351 a_1^3 + 69 a_1^2 a_2 + 3263 a_1^2 - 3 a_1 a_2^2 - 702 a_1 a_2 + a_1 b_1^2 + 1570 a_1 - 23 a_2^2 - 3263 a_2 - 2 b_1 b_2 - 18600\\
%0 &= - a_1^4 a_2 - 23 a_1^3 a_2 + 3 a_1^2 a_2^2 + 351 a_1^2 a_2 + 46 a_1 a_2^2 + 3263 a_1 a_2 - a_2^3 - 351 a_2^2 + a_2 b_1^2 + 1570 a_2 - b_2^2 \, .
%\end{align*}
\end{eg}

\subsection{Embedding the Kummer variety}
Let $X$ be a curve of genus $g$ and let $\Sym^g(X) = X^g/S_g$ be the $g^\text{th}$ symmetric power of $X$. Fixing a divisor $D_0 \in \Div(X)$ of degree $g$, recall that the map
\begin{align*}
\Sym^g(X) &\to \Jac(X)\\
\{P_1, \ldots, P_g\} &\mapsto [P_1] + \cdots + [P_g] - D_0
\end{align*}
is surjective.

Let
$$
f(x) = f_6 x^6 + f_5 x^5 + \cdots + f_1 x + f_0 \in k[x]
$$
be a polynomial with no repeated roots (in the algebraic closure $\kal$). Then
$$
X_2: y^2 = f(x)
$$
is a genus $2$ hyperelliptic curve over $k$.

We now show how to realize the Kummer surface of $X_2$ as a quartic surface in $\P^3$, as described in \cite{Mueller} and \cite{CasselsFlynn}. Suppose $P_1 = (x,y)$ and $P_2 = (u,v)$ are affine points on $X_2$. Let
\begin{align*}
\kappa_1 &= 1\\
\kappa_2 &= x+u\\
\kappa_3 &= xu\\
\kappa_4 &= \frac{F_0(x,u) - 2yv}{(x-u)^2}
\end{align*}
where
\begin{align*}
F_0(x,u) = 2 f_0 + f_1(x+u) + 2 f_2 xu + f_3(x+u)xu + 2 f_4(xu)^2 + f_5(x+u)xu + 2 f_6 (xu)^3 \, .
\end{align*}

The image of $\kappa$ is a quartic surface given by
\begin{align} \label{eqn:kummer}
K_2(\kappa_1, \kappa_2, \kappa_3) \kappa_4^2 + K_1(\kappa_1, \kappa_2, \kappa_3) \kappa_4 + K_0(\kappa_1, \kappa_2, \kappa_3) \, ,
\end{align}
where
\begin{align*}
K_2(\kappa_1, \kappa_2, \kappa_3) &= \kappa_2^2 - 4 \kappa_1 \kappa_3\\
K_1(\kappa_1, \kappa_2, \kappa_3) &= -4 \kappa_1^3 f_0 - 2 \kappa_1^2 \kappa_2 f_1 - 4 \kappa_1^2 \kappa_3 f_2 - 2 \kappa_1 \kappa_2 \kappa_3  f_3 - 4 \kappa_1 \kappa_3^2 f_4 -2 \kappa_2 \kappa_3^2 f_5 - 4 \kappa_3^3 f_6\\
K_0(\kappa_1, \kappa_2, \kappa_3) &=
-4 \kappa_1^4 f_0 f_2 + \kappa_1^4 f_1^2 - 4 \kappa_1^3 \kappa_2 f_0 f_3 - 2 \kappa_1^3 \kappa_3 f_1 f_3 - 4 \kappa_1^2 \kappa_2^2 f_0 f_4 + 4 \kappa_1^2 \kappa_2 \kappa_3 f_0 f_5\\
	&\qquad - 4 \kappa_1^2 \kappa_2 \kappa_3 f_1 f_4 - 4 \kappa_1^2 \kappa_3^2 f_0 f_6 + 2 \kappa_1^2 \kappa_3^2 f_1 f_5 -4 \kappa_1^2 \kappa_3^2 f_2 f_4 +   \kappa_1^2 \kappa_3^2 f_3^2\\
	&\qquad - 4 \kappa_1 \kappa_2^3 f_0 f_5 + 8 \kappa_1 \kappa_2^2 \kappa_3 f_0 f_6 - 4 \kappa_1 \kappa_2^2 \kappa_3 f_1 f_5 + 4 \kappa_1 \kappa_2 \kappa_3^2 f_1 f_6 - 4 \kappa_1 \kappa_2 \kappa_3^2 f_2 f_5\\
	&\qquad - 2  \kappa_1 \kappa_3^3 f_3 f_5 - 4 \kappa_2^4 f_0 f_6 - 4 \kappa_2^3 \kappa_3 f_1 f_6 - 4 \kappa_2^2 \kappa_3^2 f_2  f_6 -4 \kappa_2 \kappa_3^3 f_3 f_6 - 4 \kappa_3^4 f_4 f_6\\
	&\qquad + \kappa_3^4 f_5^2 \, .
\end{align*}
Then the Kummer surface $K$ is given by equation (\ref{eqn:kummer}) and the map $\kappa = [\kappa_1 : \kappa_2 : \kappa_3 : \kappa_4]$ is the desired map $\Jac(X_2) \to K$.
\section{Overview of method}

Our construction proceeds as follows. We take as input an elliptic curve $X_1$ and a genus $2$ curve $X_2$ over a number field $k$ \sss{or more genenerally, any field? characteristic $\neq 2$?} given in Weierstrass form
$$
X_1: y^2 + u(x) y = v(x) \qquad
X_2: y^2 + h(x) y = f(x) \, .
$$
Letting $J_2$ be the Jacobian variety of $X_2$, then $J_2$ is an abelian surface with $16$ $2$-torsion points. The Kummer variety $K_2$ of $X_2$ is obtained by forming the quotient of $J_2$ by the negation map $[-1]$. This quotient map $\pi : J_2 \to K_2$ is injective on the $2$-torsion points of $J_2$, whose images are the singular points of $K_2$. \sss{Nodes, I guess?} Using  the explicit embedding given in \cite{Mueller} (which in turn is a generalization of \cite{CasselsFlynn}), we can realize $K_2$ as a quartic surface in $\P^3$.

Fix two nodes $T_1, T_2$ of $K_2$. Consider the pencil of planes $\mathcal{H} = \{H_\mu : \mu \in \P^1\}$ passing through $T_1$ and $T_2$. The intersection of a plane $H_\mu \in \mathcal{H}$ with $K_2$ is a quartic plane curve $C_\mu$ with two nodes. By the usual degree-genus formula for plane curves, $C_\mu$ has genus $1$ for each $\mu \in \P^1$. We will endow $C_\mu$ with the structure of an elliptic curve and compute its $j$-invariant as a function of $\mu$.

To a point $Q \in C_\mu$ we associate the line $\ell_Q$ passing through $T_1$ and $Q$. The association $Q \mapsto \ell_Q$ defines a degree $2$ map $C_\mu \to \P^1$ ramified at 4 points. Computing the cross-ratio of these 4 points yields the $\lambda$-invariant of $C_\mu$, allowing us to find a Legendre model $y^2 = x(x-1)(x-\lambda)$ for $C_\mu$. We can then compute the $j$-invariant of $C_\mu$ using the standard formula
$$
j = 2^8 \frac{(\lambda^2 - \lambda + 1)^3}{\lambda^2 (\lambda-1)^2}  \, .
$$
Note that computing the $\lambda$-invariant of $C_\mu$ not only endows $C_\mu$ with the structure of an elliptic curve, but also with level $2$ structure: the Legendre model $E_\text{Leg}: y^2 = x(x-1)(x-\lambda)$ comes equipped with the basis $\{(0,0), (1,0)\}$ for $E_\text{Leg}[2]$, and we may pull back this basis along the isomorphism $C_\mu \overset{\sim}{\to} E_\text{Leg}$ to obtain a basis for $C_\mu[2]$.
\begin{lem}
The composite map
%\begin{align*}
%\P^1 &\to \mathcal{M}_1 \to X(2) \to X(1)\\
%
%\end{align*}
$$
\begin{tikzcd}[row sep = small]
\varphi: \P^1 \ar[]{r}{} & \mathcal{M}_1 \ar[]{r}{} & X(2) \ar[]{r}{} & X(1)\\ 
\mu \ar[mapsto]{r}{} & C_\mu \ar[mapsto]{r}{} & \lambda(C_\mu) \ar[mapsto]{r}{} & j(\lambda(C_\mu))
\end{tikzcd}
$$
has degree $12$.
\end{lem}

\begin{proof}
By the classical theory of modular functions, the map $X(2) \to X(1)$, $\lambda \mapsto j(\lambda)$ has degree $6$, corresponding to the $6$ permutations of $0, 1, \infty$ acted on by $S_3$. As the map $\mu \mapsto C_\mu$ has degree $1$, it suffices to show that the map $\mathcal{M}_1 \to X(2)$ has degree $2$. \sss{I think this just follows from the fact that we could've chosen to the other node and taken lines through $T_2$ and $Q$ to obtain a map to $\P^1$. I guess we have to show that this would produce the same $\lambda$...}
\end{proof}

Thus the composite map in the above lemma is a rational function of degree $12$ in $\mu$. Let $j_1 = j(X_1)$. In order to find a value of $\mu$ that yields an elliptic curve $C_\mu$ isomorphic to our original curve $X_1$, we solve the equation $\varphi(\mu) = j_1$. The solutions $\mu$ to this equation may not lie in the ground field, so it may be necessary to base change our curve to an algebraic extension. \sss{I think in all the examples so far we've only needed quadratic extensions of the base field...} \sss{One more interesting note: I think in all the examples we've done so far, $\varphi(\mu) - j_1$ has an interesting factorization. The numerator is a product of quadratics, and the denominator is a product of linear factors squared. Is this expected?}

\section{Comparison with analytic construction}
The first author has also described a complex analytic method for glueing a genus $1$ and a genus $2$ curve along their $2$-torsion using period matrices. In this section we compare these two methods of glueing.

\section{Applications}
Constructing abelian three-folds with interesting torsion?

\section{Examples}

%\nocite{*} % use this to have all references listed, not just those cited
%\bibliographystyle{amsplain}
\bibliographystyle{alpha}
%\addcontentsline{toc}{chapter}{References}
\bibliography{references}


\end{document} 
